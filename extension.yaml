name: loric-edu-analytics
version: 0.0.1
specVersion: v1beta
displayName: LoricEdu
description: Analytics Aggregator for Loric Edu
icon: icon.png
license: Apache-2.0
sourceUrl: https://github.com/srikantloric/New-folder--2-
billingRequired: true

author:
  authorName: Your Companyyy
  email: extensions@example.com
  url: https://example.com/

contributors:
  - authorName: Your Name
    email: you@example.com
  - authorName: Another Contributor
    email: colleague@example.net
    url: https://github.com/their-org/

params:
  - param: PROJECT_ID
    label: Firebase Project ID
    description: Project ID where the payments collection exists
    type: string
  - param: ENABLE_ANALYTICS
    label: Enable Analytics Aggregation
    description: Set to true to enable analytics logic, false to disable.
    type: select
    options:
      - label: Enabled
        value: true
      - label: Disabled
        value: false
    default: true

resources:
  - name: onPaymentAdd
    type: firebaseextensions.v1beta.function
    properties:
      eventTrigger:
        eventType: providers/cloud.firestore/eventTypes/document.create
        resource: projects/${PROJECT_ID}/databases/(default)/documents/MY_PAYMENTS/{paymentId}
      entryPoint: onPaymentAdd
      runtime: nodejs20

  - name: onPaymentDelete
    type: firebaseextensions.v1beta.function
    properties:
      eventTrigger:
        eventType: providers/cloud.firestore/eventTypes/document.delete
        resource: projects/${PROJECT_ID}/databases/(default)/documents/MY_PAYMENTS/{paymentId}
      entryPoint: onPaymentDelete
      runtime: nodejs20

roles:
  - role: datastore.owner
    reason: The extension needs to update aggregated analytics in Firestore.

  - role: datastore.user
    reason: The extension needs to read documents from Firestore.  